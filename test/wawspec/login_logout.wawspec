scenario __FILE__ do
  people_mail = "test-user@acmscw.be"
  people = {:mail => people_mail, :password => "mypassword"}
  Waw.resources.business.people.drop_people(people_mail)
  Waw.resources.model.people.insert(people.merge(:adminlevel => 0))
  
  assert_not_404 Waw.config.web_base
  assert_i_see "Connexion"
  
  assert_form_service_invoke "Successful login then", {
    :service    => "/webserv/people/login",
    :arguments  => {:mail => people[:mail], :password => people[:password]},
    :result     => "success/ok"
  }
  assert_not_404 Waw.config.web_base + 'securite-vie-privee'
  assert_i_see "My chapter"
  assert_i_see "Logout"
  
  assert_form_service_invoke "Successful logout then", {
    :service    => "/webserv/people/logout",
    :arguments  => {},
    :result     => "success/ok",
    :check_form => false
  }
  assert_not_404 Waw.config.web_base + 'events'
  assert_i_see "Connexion"
  assert_i_dont_see "My chapter"
  assert_i_dont_see "Logout"
end